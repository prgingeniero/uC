
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="http://prg.engineer/Linear_Regression_with_Synthetic_Data/">
      
      <link rel="icon" href="../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.2.5">
    
    
      
        <title>Linear Regression with Synthetic Data - PRG</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.2d9f7617.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/ansi-colours.css">
    
      <link rel="stylesheet" href="../css/jupyter-cells.css">
    
      <link rel="stylesheet" href="../css/pandas-dataframe.css">
    
    <script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-BY8HY373BD"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&gtag("event","search",{search_term:this.value})}),"undefined"!=typeof location$&&location$.subscribe(function(e){gtag("config","G-BY8HY373BD",{page_path:e.pathname})})})</script>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-BY8HY373BD"></script>


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#simple-linear-regression-with-synthetic-data" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href=".." title="PRG" class="md-header__button md-logo" aria-label="PRG" data-md-component="logo">
      
  <img src="../assets/logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PRG
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Linear Regression with Synthetic Data
            
          </span>
        </div>
      </div>
    </div>
    
    
      <div class="md-header__option">
        <div class="md-select">
          
          <button class="md-header__button md-icon" aria-label="Seleccionar idioma">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.52 17.52 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04M18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12m-2.62 7 1.62-4.33L19.12 17h-3.24z"/></svg>
          </button>
          <div class="md-select__inner">
            <ul class="md-select__list">
              
                <li class="md-select__item">
                  <a href="/" hreflang="es" class="md-select__link">
                    Español
                  </a>
                </li>
                
                <li class="md-select__item">
                  <a href="/en/" hreflang="en" class="md-select__link">
                    English
                  </a>
                </li>
                
            </ul>
          </div>
        </div>
      </div>
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Limpiar" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Pestañas" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href=".." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../ExploringLoss/" class="md-tabs__link">
      ExploringLoss
    </a>
  </li>

      
        
  
  
    
  


  <li class="md-tabs__item">
    <a href="./" class="md-tabs__link md-tabs__link--active">
      Linear Regression with Synthetic Data
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../Welcome_To_Colaboratory/" class="md-tabs__link">
      Welcome To Colaboratory
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../contacto/" class="md-tabs__link">
      Contacto
    </a>
  </li>

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="PRG" class="md-nav__button md-logo" aria-label="PRG" data-md-component="logo">
      
  <img src="../assets/logo.svg" alt="logo">

    </a>
    PRG
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../ExploringLoss/" class="md-nav__link">
        ExploringLoss
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Linear Regression with Synthetic Data
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Linear Regression with Synthetic Data
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#learning-objectives" class="md-nav__link">
    Learning objectives:
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#about-colabs" class="md-nav__link">
    About Colabs
  </a>
  
    <nav class="md-nav" aria-label="About Colabs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#running-code-cells" class="md-nav__link">
    Running code cells
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#understanding-hidden-code-cells" class="md-nav__link">
    Understanding hidden code cells
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-did-you-see-an-error" class="md-nav__link">
    Why did you see an error?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#use-the-right-version-of-tensorflow" class="md-nav__link">
    Use the right version of TensorFlow
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#import-relevant-modules" class="md-nav__link">
    Import relevant modules
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#define-functions-that-build-and-train-a-model" class="md-nav__link">
    Define functions that build and train a model
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#define-plotting-functions" class="md-nav__link">
    Define plotting functions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#define-the-dataset" class="md-nav__link">
    Define the dataset
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#specify-the-hyperparameters" class="md-nav__link">
    Specify the hyperparameters
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-1-examine-the-graphs" class="md-nav__link">
    Task 1: Examine the graphs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-2-increase-the-number-of-epochs" class="md-nav__link">
    Task 2: Increase the number of epochs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-3-increase-the-learning-rate" class="md-nav__link">
    Task 3: Increase the learning rate
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-4-find-the-ideal-combination-of-epochs-and-learning-rate" class="md-nav__link">
    Task 4: Find the ideal combination of epochs and learning rate
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-5-adjust-the-batch-size" class="md-nav__link">
    Task 5: Adjust the batch size
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary-of-hyperparameter-tuning" class="md-nav__link">
    Summary of hyperparameter tuning
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../Welcome_To_Colaboratory/" class="md-nav__link">
        Welcome To Colaboratory
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../contacto/" class="md-nav__link">
        Contacto
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#learning-objectives" class="md-nav__link">
    Learning objectives:
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#about-colabs" class="md-nav__link">
    About Colabs
  </a>
  
    <nav class="md-nav" aria-label="About Colabs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#running-code-cells" class="md-nav__link">
    Running code cells
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#understanding-hidden-code-cells" class="md-nav__link">
    Understanding hidden code cells
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-did-you-see-an-error" class="md-nav__link">
    Why did you see an error?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#use-the-right-version-of-tensorflow" class="md-nav__link">
    Use the right version of TensorFlow
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#import-relevant-modules" class="md-nav__link">
    Import relevant modules
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#define-functions-that-build-and-train-a-model" class="md-nav__link">
    Define functions that build and train a model
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#define-plotting-functions" class="md-nav__link">
    Define plotting functions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#define-the-dataset" class="md-nav__link">
    Define the dataset
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#specify-the-hyperparameters" class="md-nav__link">
    Specify the hyperparameters
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-1-examine-the-graphs" class="md-nav__link">
    Task 1: Examine the graphs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-2-increase-the-number-of-epochs" class="md-nav__link">
    Task 2: Increase the number of epochs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-3-increase-the-learning-rate" class="md-nav__link">
    Task 3: Increase the learning rate
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-4-find-the-ideal-combination-of-epochs-and-learning-rate" class="md-nav__link">
    Task 4: Find the ideal combination of epochs and learning rate
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-5-adjust-the-batch-size" class="md-nav__link">
    Task 5: Adjust the batch size
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary-of-hyperparameter-tuning" class="md-nav__link">
    Summary of hyperparameter tuning
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script>
(function() {
  function addWidgetsRenderer() {
    var requireJsScript = document.createElement('script');
    requireJsScript.src = 'https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js';

    var mimeElement = document.querySelector('script[type="application/vnd.jupyter.widget-view+json"]');
    var jupyterWidgetsScript = document.createElement('script');
    var widgetRendererSrc = 'https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js';
    var widgetState;

    // Fallback for older version:
    try {
      widgetState = mimeElement && JSON.parse(mimeElement.innerHTML);

      if (widgetState && (widgetState.version_major < 2 || !widgetState.version_major)) {
        widgetRendererSrc = 'jupyter-js-widgets@*/dist/embed.js';
      }
    } catch(e) {}

    jupyterWidgetsScript.src = widgetRendererSrc;

    document.body.appendChild(requireJsScript);
    document.body.appendChild(jupyterWidgetsScript);
  }

  document.addEventListener('DOMContentLoaded', addWidgetsRenderer);
}());
</script>

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code>#@title Copyright 2020 Google LLC. Double-click here for license information.
# Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# https://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="simple-linear-regression-with-synthetic-data">Simple Linear Regression with Synthetic Data</h1>
<p>In this first Colab, you'll explore linear regression with a simple database. </p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="learning-objectives">Learning objectives:</h2>
<p>After doing this exercise, you'll know how to do the following:</p>
<ul>
<li>Run Colabs.</li>
<li>Tune the following <a href="https://developers.google.com/machine-learning/glossary/#hyperparameter">hyperparameters</a>:<ul>
<li><a href="https://developers.google.com/machine-learning/glossary/#learning_rate">learning rate</a></li>
<li>number of <a href="https://developers.google.com/machine-learning/glossary/#epoch">epochs</a></li>
<li><a href="https://developers.google.com/machine-learning/glossary/#batch_size">batch size</a></li>
</ul>
</li>
<li>Interpret different kinds of <a href="https://developers.google.com/machine-learning/glossary/#loss_curve">loss curves</a>.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="about-colabs">About Colabs</h2>
<p>Machine Learning Crash Course uses Colaboratories (<strong>Colabs</strong>) for all programming exercises. Colab is Google's implementation of <a href="https://jupyter.org/">Jupyter Notebook</a>. Like all Jupyter Notebooks, a Colab consists of two kinds of components:</p>
<ul>
<li><strong>Text cells</strong>, which contain explanations. You are currently reading a text cell.</li>
<li><strong>Code cells</strong>, which contain Python code for you to run. Code cells have a light gray background.</li>
</ul>
<p>You <em>read</em> the text cells and <em>run</em> the code cells.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="running-code-cells">Running code cells</h3>
<p>You must run code cells in order. In other words, you may only run a code cell once all the code cells preceding it have already been run. </p>
<p>To run a code cell:</p>
<ol>
<li>Place the cursor anywhere inside the [ ] area at the top left of a code cell. The area inside the [ ] will display an arrow.</li>
<li>Click the arrow.</li>
</ol>
<p>Alternatively, you may invoke <strong>Runtime-&gt;Run all</strong>. Note, though, that some of the code cells will fail because not all the coding is complete. (You'll complete the coding as part of the exercise.)</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="understanding-hidden-code-cells">Understanding hidden code cells</h3>
<p>We've <strong>hidden</strong> the code in code cells that don't advance the learning objectives. For example, we've hidden the code that plots graphs. However, <strong>you must still run code cells containing hidden code</strong>. You'll know that the code is hidden because you'll see a title (for example, "Load the functions that build and train a model") without seeing the code.</p>
<p>To view the hidden code, just double click the header.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="why-did-you-see-an-error">Why did you see an error?</h3>
<p>If a code cell returns an error when you run it, consider two common problems:</p>
<ul>
<li>You didn't run <em>all</em> of the code cells preceding the current code cell.</li>
<li>If the code cell is labeled as a <strong>Task</strong>, then you haven't written the necessary code. </li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="use-the-right-version-of-tensorflow">Use the right version of TensorFlow</h2>
<p>The following hidden code cell ensures that the Colab will run on TensorFlow 2.X, which is the most recent version of TensorFlow:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code>#@title Run this Colab on TensorFlow 2.x
%tensorflow_version 2.x
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="import-relevant-modules">Import relevant modules</h2>
<p>The following cell imports the packages that the program requires:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code>import pandas as pd
import tensorflow as tf
from matplotlib import pyplot as plt
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="define-functions-that-build-and-train-a-model">Define functions that build and train a model</h2>
<p>The following code defines two functions:</p>
<ul>
<li><code>build_model(my_learning_rate)</code>, which builds an empty model.</li>
<li><code>train_model(model, feature, label, epochs)</code>, which trains the model from the examples (feature and label) you pass. </li>
</ul>
<p>Since you don't need to understand model building code right now, we've hidden this code cell.  You may optionally double-click the headline to explore this code.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code>#@title Define the functions that build and train a model
def build_model(my_learning_rate):
  &quot;&quot;&quot;Create and compile a simple linear regression model.&quot;&quot;&quot;
  # Most simple tf.keras models are sequential. 
  # A sequential model contains one or more layers.
  model = tf.keras.models.Sequential()

  # Describe the topography of the model.
  # The topography of a simple linear regression model
  # is a single node in a single layer. 
  model.add(tf.keras.layers.Dense(units=1, 
                                  input_shape=(1,)))

  # Compile the model topography into code that 
  # TensorFlow can efficiently execute. Configure 
  # training to minimize the model&#39;s mean squared error. 
  model.compile(optimizer=tf.keras.optimizers.RMSprop(lr=my_learning_rate),
                loss=&quot;mean_squared_error&quot;,
                metrics=[tf.keras.metrics.RootMeanSquaredError()])

  return model           


def train_model(model, feature, label, epochs, batch_size):
  &quot;&quot;&quot;Train the model by feeding it data.&quot;&quot;&quot;

  # Feed the feature values and the label values to the 
  # model. The model will train for the specified number 
  # of epochs, gradually learning how the feature values
  # relate to the label values. 
  history = model.fit(x=feature,
                      y=label,
                      batch_size=batch_size,
                      epochs=epochs)

  # Gather the trained model&#39;s weight and bias.
  trained_weight = model.get_weights()[0]
  trained_bias = model.get_weights()[1]

  # The list of epochs is stored separately from the 
  # rest of history.
  epochs = history.epoch

  # Gather the history (a snapshot) of each epoch.
  hist = pd.DataFrame(history.history)

  # Specifically gather the model&#39;s root mean 
  #squared error at each epoch. 
  rmse = hist[&quot;root_mean_squared_error&quot;]

  return trained_weight, trained_bias, epochs, rmse

print(&quot;Defined create_model and train_model&quot;)
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="define-plotting-functions">Define plotting functions</h2>
<p>We're using a popular Python library called <a href="https://developers.google.com/machine-learning/glossary/#matplotlib">Matplotlib</a> to create the following two plots:</p>
<ul>
<li>a plot of the feature values vs. the label values, and a line showing the output of the trained model.</li>
<li>a <a href="https://developers.google.com/machine-learning/glossary/#loss_curve">loss curve</a>.</li>
</ul>
<p>We hid the following code cell because learning Matplotlib is not relevant to the learning objectives. Regardless, you must still run all hidden code cells.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code>#@title Define the plotting functions
def plot_the_model(trained_weight, trained_bias, feature, label):
  &quot;&quot;&quot;Plot the trained model against the training feature and label.&quot;&quot;&quot;

  # Label the axes.
  plt.xlabel(&quot;feature&quot;)
  plt.ylabel(&quot;label&quot;)

  # Plot the feature values vs. label values.
  plt.scatter(feature, label)

  # Create a red line representing the model. The red line starts
  # at coordinates (x0, y0) and ends at coordinates (x1, y1).
  x0 = 0
  y0 = trained_bias
  x1 = feature[-1]
  y1 = trained_bias + (trained_weight * x1)
  plt.plot([x0, x1], [y0, y1], c=&#39;r&#39;)

  # Render the scatter plot and the red line.
  plt.show()

def plot_the_loss_curve(epochs, rmse):
  &quot;&quot;&quot;Plot the loss curve, which shows loss vs. epoch.&quot;&quot;&quot;

  plt.figure()
  plt.xlabel(&quot;Epoch&quot;)
  plt.ylabel(&quot;Root Mean Squared Error&quot;)

  plt.plot(epochs, rmse, label=&quot;Loss&quot;)
  plt.legend()
  plt.ylim([rmse.min()*0.97, rmse.max()])
  plt.show()

print(&quot;Defined the plot_the_model and plot_the_loss_curve functions.&quot;)
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="define-the-dataset">Define the dataset</h2>
<p>The dataset consists of 12 <a href="https://developers.google.com/machine-learning/glossary/#example">examples</a>. Each example consists of one <a href="https://developers.google.com/machine-learning/glossary/#feature">feature</a> and one <a href="https://developers.google.com/machine-learning/glossary/#label">label</a>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code>my_feature = ([1.0, 2.0,  3.0,  4.0,  5.0,  6.0,  7.0,  8.0,  9.0, 10.0, 11.0, 12.0])
my_label   = ([5.0, 8.8,  9.6, 14.2, 18.8, 19.5, 21.4, 26.8, 28.9, 32.0, 33.8, 38.2])
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="specify-the-hyperparameters">Specify the hyperparameters</h2>
<p>The hyperparameters in this Colab are as follows:</p>
<ul>
<li><a href="https://developers.google.com/machine-learning/glossary/#learning_rate">learning rate</a></li>
<li><a href="https://developers.google.com/machine-learning/glossary/#epoch">epochs</a></li>
<li><a href="https://developers.google.com/machine-learning/glossary/#batch_size">batch_size</a></li>
</ul>
<p>The following code cell initializes these hyperparameters and then invokes the functions that build and train the model.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code>learning_rate=0.01
epochs=10
my_batch_size=12

my_model = build_model(learning_rate)
trained_weight, trained_bias, epochs, rmse = train_model(my_model, my_feature, 
                                                         my_label, epochs,
                                                         my_batch_size)
plot_the_model(trained_weight, trained_bias, my_feature, my_label)
plot_the_loss_curve(epochs, rmse)
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="task-1-examine-the-graphs">Task 1: Examine the graphs</h2>
<p>Examine the top graph. The blue dots identify the actual data; the red line identifies the output of the trained model. Ideally, the red line should align nicely with the blue dots.  Does it?  Probably not.</p>
<p>A certain amount of randomness plays into training a model, so you'll get somewhat different results every time you train.  That said, unless you are an extremely lucky person, the red line probably <em>doesn't</em> align nicely with the blue dots.  </p>
<p>Examine the bottom graph, which shows the loss curve. Notice that the loss curve decreases but doesn't flatten out, which is a sign that the model hasn't trained sufficiently.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="task-2-increase-the-number-of-epochs">Task 2: Increase the number of epochs</h2>
<p>Training loss should steadily decrease, steeply at first, and then more slowly. Eventually, training loss should eventually stay steady (zero slope or nearly zero slope), which indicates that training has <a href="http://developers.google.com/machine-learning/glossary/#convergence">converged</a>.</p>
<p>In Task 1, the training loss did not converge. One possible solution is to train for more epochs.  Your task is to increase the number of epochs sufficiently to get the model to converge. However, it is inefficient to train past convergence, so don't just set the number of epochs to an arbitrarily high value.</p>
<p>Examine the loss curve. Does the model converge?</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code>learning_rate=0.01
epochs= ?   # Replace ? with an integer.
my_batch_size=12

my_model = build_model(learning_rate)
trained_weight, trained_bias, epochs, rmse = train_model(my_model, my_feature, 
                                                        my_label, epochs,
                                                        my_batch_size)
plot_the_model(trained_weight, trained_bias, my_feature, my_label)
plot_the_loss_curve(epochs, rmse)
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code>#@title Double-click to view a possible solution
learning_rate=0.01
epochs=450
my_batch_size=12 

my_model = build_model(learning_rate)
trained_weight, trained_bias, epochs, rmse = train_model(my_model, my_feature, 
                                                         my_label, epochs,
                                                         my_batch_size)
plot_the_model(trained_weight, trained_bias, my_feature, my_label)
plot_the_loss_curve(epochs, rmse)

# The loss curve suggests that the model does converge.
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="task-3-increase-the-learning-rate">Task 3: Increase the learning rate</h2>
<p>In Task 2, you increased the number of epochs to get the model to converge. Sometimes, you can get the model to converge more quickly by increasing the learning rate. However, setting the learning rate too high often makes it impossible for a model to converge. In Task 3, we've intentionally set the learning rate too high. Run the following code cell and see what happens.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code># Increase the learning rate and decrease the number of epochs.
learning_rate=100 
epochs=500 

my_model = build_model(learning_rate)
trained_weight, trained_bias, epochs, rmse = train_model(my_model, my_feature, 
                                                         my_label, epochs,
                                                         my_batch_size)
plot_the_model(trained_weight, trained_bias, my_feature, my_label)
plot_the_loss_curve(epochs, rmse)
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The resulting model is terrible; the red line doesn't align with the blue dots. Furthermore, the loss curve oscillates like a <a href="https://www.wikipedia.org/wiki/Roller_coaster">roller coaster</a>.  An oscillating loss curve strongly suggests that the learning rate is too high. </p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="task-4-find-the-ideal-combination-of-epochs-and-learning-rate">Task 4: Find the ideal combination of epochs and learning rate</h2>
<p>Assign values to the following two hyperparameters to make training converge as efficiently as possible: </p>
<ul>
<li>learning_rate</li>
<li>epochs</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code># Set the learning rate and number of epochs
learning_rate= ?  # Replace ? with a floating-point number
epochs= ?   # Replace ? with an integer

my_model = build_model(learning_rate)
trained_weight, trained_bias, epochs, rmse = train_model(my_model, my_feature, 
                                                         my_label, epochs,
                                                         my_batch_size)
plot_the_model(trained_weight, trained_bias, my_feature, my_label)
plot_the_loss_curve(epochs, rmse)
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code>#@title Double-click to view a possible solution

learning_rate=0.14
epochs=70
my_batch_size=12

my_model = build_model(learning_rate)
trained_weight, trained_bias, epochs, rmse = train_model(my_model, my_feature, 
                                                         my_label, epochs,
                                                         my_batch_size)
plot_the_model(trained_weight, trained_bias, my_feature, my_label)
plot_the_loss_curve(epochs, rmse)
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="task-5-adjust-the-batch-size">Task 5: Adjust the batch size</h2>
<p>The system recalculates the model's loss value and adjusts the model's weights and bias after each <strong>iteration</strong>.  Each iteration is the span in which the system processes one batch. For example, if the <strong>batch size</strong> is 6, then the system recalculates the model's loss value and adjusts the model's weights and bias after processing every 6 examples.  </p>
<p>One <strong>epoch</strong> spans sufficient iterations to process every example in the dataset. For example, if the batch size is 12, then each epoch lasts one iteration. However, if the batch size is 6, then each epoch consumes two iterations.  </p>
<p>It is tempting to simply set the batch size to the number of examples in the dataset (12, in this case). However, the model might actually train faster on smaller batches. Conversely, very small batches might not contain enough information to help the model converge. </p>
<p>Experiment with <code>batch_size</code> in the following code cell. What's the smallest integer you can set for <code>batch_size</code> and still have the model converge in a hundred epochs?</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code>learning_rate=0.05
epochs=100
my_batch_size= ?  # Replace ? with an integer.

my_model = build_model(learning_rate)
trained_weight, trained_bias, epochs, rmse = train_model(my_model, my_feature, 
                                                        my_label, epochs,
                                                        my_batch_size)
plot_the_model(trained_weight, trained_bias, my_feature, my_label)
plot_the_loss_curve(epochs, rmse)
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code>#@title Double-click to view a possible solution

learning_rate=0.05
epochs=125
my_batch_size=1 # Wow, a batch size of 1 works!

my_model = build_model(learning_rate)
trained_weight, trained_bias, epochs, rmse = train_model(my_model, my_feature, 
                                                         my_label, epochs,
                                                         my_batch_size)
plot_the_model(trained_weight, trained_bias, my_feature, my_label)
plot_the_loss_curve(epochs, rmse)
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="summary-of-hyperparameter-tuning">Summary of hyperparameter tuning</h2>
<p>Most machine learning problems require a lot of hyperparameter tuning.  Unfortunately, we can't provide concrete tuning rules for every model. Lowering the learning rate can help one model converge efficiently but make another model converge much too slowly.  You must experiment to find the best set of hyperparameters for your dataset. That said, here are a few rules of thumb:</p>
<ul>
<li>Training loss should steadily decrease, steeply at first, and then more slowly until the slope of the curve reaches or approaches zero. </li>
<li>If the training loss does not converge, train for more epochs.</li>
<li>If the training loss decreases too slowly, increase the learning rate. Note that setting the learning rate too high may also prevent training loss from converging.</li>
<li>If the training loss varies wildly (that is, the training loss jumps around), decrease the learning rate.</li>
<li>Lowering the learning rate while increasing the number of epochs or the batch size is often a good combination.</li>
<li>Setting the batch size to a <em>very</em> small batch number can also cause instability. First, try large batch size values. Then, decrease the batch size until you see degradation.</li>
<li>For real-world datasets consisting of a very large number of examples, the entire dataset might not fit into memory. In such cases, you'll need to reduce the batch size to enable a batch to fit into memory. </li>
</ul>
<p>Remember: the ideal combination of hyperparameters is data dependent, so you must always experiment and verify.</p>
</div>
</div>
</div>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Pie">
      
        
        <a href="../ExploringLoss/" class="md-footer__link md-footer__link--prev" aria-label="Anterior: ExploringLoss" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Anterior
              </span>
              ExploringLoss
            </div>
          </div>
        </a>
      
      
        
        <a href="../Welcome_To_Colaboratory/" class="md-footer__link md-footer__link--next" aria-label="Siguiente: Welcome To Colaboratory" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Siguiente
              </span>
              Welcome To Colaboratory
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      © 2021 PRG
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.tabs.sticky"], "translations": {"clipboard.copy": "Copiar al portapapeles", "clipboard.copied": "Copiado al portapapeles", "search.config.lang": "es", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "B\u00fasqueda", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.term.missing": "Falta", "select.version.title": "Seleccionar versi\u00f3n"}, "search": "../assets/javascripts/workers/search.bd0b6b67.min.js"}</script>
    
    
      <script src="../assets/javascripts/bundle.467223ff.min.js"></script>
      
        <script src="../javascripts/config.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>